---
description: アプリでモバイル Web コンテンツを開く場合は、訪問者がネイティブアプリからモバイル Web に移動したり、その逆に移動したりしても、別の訪問者として識別されないようにする必要があります。
seo-description: アプリでモバイル Web コンテンツを開く場合は、訪問者がネイティブアプリからモバイル Web に移動したり、その逆に移動したりしても、別の訪問者として識別されないようにする必要があります。
seo-title: アプリとモバイル Web にまたがる訪問者トラッキング
solution: Marketing Cloud,Analytics
title: アプリとモバイル Web にまたがる訪問者トラッキング
topic: 開発者と導入
uuid: 2d951de6-3954-4379-a4ff-99b9695b9869
translation-type: tm+mt
source-git-commit: 9257d6b6c2c14d0422cda65fcc9c677ac5ac47a9

---


# Visitor tracking between an app and mobile web  {#visitor-tracking-between-an-app-and-mobile-web}

アプリでモバイル Web コンテンツを開く場合は、訪問者がネイティブアプリからモバイル Web に移動したり、その逆に移動したりしても、別の訪問者として識別されないようにする必要があります。

## アプリ内の訪問者ID

アプリをインストールすると、iOS SDK が一意の訪問者 ID を生成します。この ID はモバイルデバイスの持続メモリに保存され、各ヒットとともに送信されます。この ID が削除されるのは、ユーザーがアプリをアンインストールしたときだけです。。

>[!TIP]
>
>アプリの訪問者IDはアップグレード後も保持されます。

## Visitor IDs in the mobile web

一般的なモバイル Web 実装では、デスクトップサイトで使用されているのと同じ標準の Analytics `s_code.js` または `AppMeasurement.js` を使用します。JavaScript ライブラリには、一意の訪問者 ID を生成する独自メソッドがあり、アプリからモバイル Web コンテンツを開くと、異なる訪問者 ID が生成される原因となります。

To use the same visitor ID in the app and mobile web and pass the app visitor ID to the mobile web in the URL:

## Implement visitor tracking between an app and mobile web {#section_EDC91D6C67AD43999227707C2769C65D}

1. ライブラリをプロジェクトに追加し、ライフサイクルを実装します。

   詳しくは、コア実装とラ *イフサイクルでのプロジェクトへのSDKと設定ファイルの追加* ( [英語のみ)を参照してください](/help/ios/getting-started/dev-qs.md)。
1. Web ビューを開くために使用される URL に訪問者情報を追加するために、`visitorAppendToURL` を呼び出します。

   ```objective-c
   NSURL *url = [NSURL URLWithString:@”https://www.mydomain.com/index.php"]; 
   NSURL *urlWithVisitorData = [ADBMobile visitorAppendToURL:url]; 
   [[UIApplication sharedApplication] openURL:urlWithVisitorData];
   ```

   あるいは、SDK バージョン 4.16.0 以降では、`visitorGetUrlVariablesAsync:` を呼び出して独自の URL を生成できます。

   ```objective-c
   NSString *urlString = @"https://www.mydomain.com/index.php"; 
   [ADBMobile visitorGetUrlVariablesAsync:^(NSString * _Nullable urlVariables) { 
       NSString *urlStringWithVisitorData = [NSString stringWithFormat:@"%@?%@", urlString, urlVariables]; 
       NSURL *urlWithVisitorData = [NSURL URLWithString:urlStringWithVisitorData]; 
       [[UIApplication sharedApplication] openURL:urlWithVisitorData options:@{} completionHandler:^(BOOL success) { 
           // handle openURL success 
       }]; 
   }];
   ```

アドビに新しい ID のリクエストを送信するのではなく、宛先ドメインの ID サービスコードによって、URL から MID が抽出されます。宛先ページの ID サービスコードは、MID で渡された値を使用して訪問者を追跡します。

モバイル Web コンテンツからのヒットが発生したら、各ヒットに `mid` パラメーターが存在することと、この値がアプリのコードによって送信される `mid` と一致していることを確認します。

## 訪問者トラッキングのトラブルシューティング {#section_C070AE85E3CE4E9893FD4F40E73F2C92}

### I do not see `[ADBMobile visitorAppendToURL:]`.

親アプリケーションにバンドルされている Adobe SDK がバージョン 4.12.0 以上であることを確認します。

### URL に Adobe ID が表示されません。

以下を確認します。

* The URL string that is being used to open the web view was generated by  `[ADBMobile visitorAppendToURL:]`

* Adobe ID がエンコードされている。

   To verify that IDs are appended to the URL that is being opened, look for the `adobe_mc` query parameter.

### アプリと Web ビューの 'mid' が同一ではありません。*

以下を確認します。

* The URL string that is being used to open the web view was generated by `[ADBMobile visitorAppendToURL:]`

   URL 文字列に Adobe パラメーターが含まれている。

   The string should contain `adobe_mc="SAMPLE_ID_DATA"` where `"SAMPLE_ID_DATA"` contains the IDs that are generated in the Adobe Mobile SDK.

* `VisitorAPI.js` がバージョン 1.7.0 以上である。

これらのトラブルシューティング手順で問題が解決しない場合は、Adobe Client Care にご連絡ください。アドビが実装を検証できるよう、サンプルアプリケーションや関連サイトを共有する準備をしてください。
